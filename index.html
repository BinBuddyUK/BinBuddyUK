<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BinBuddy UK - Smart Waste Management</title>
  <meta name="description" content="Smart bin collection reminders for UK households" />
  <meta name="theme-color" content="#5D5CDE" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="apple-touch-icon" href="/icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="BinBuddy UK" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#5D5CDE',
            'bin-general': '#4B5563',
            'bin-recycling': '#10B981',
            'bin-garden': '#F59E0B',
            'bin-food': '#8B5CF6'
          },
          boxShadow: {
            'soft': '0 4px 12px rgba(0, 0, 0, 0.05)',
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen text-gray-800 dark:text-gray-100">
  <div class="max-w-md mx-auto p-4">
    <!-- Header -->
    <header class="text-center py-6">
      <h1 class="text-4xl font-bold text-primary mb-2">BinBuddy UK</h1>
      <p class="text-sm text-gray-500 dark:text-gray-400">Your smart bin collection assistant</p>
    </header><!-- Tabs -->
<nav class="flex justify-between bg-white dark:bg-gray-800 rounded-xl shadow-soft p-2 mb-4">
  <button onclick="showTab('schedule')" class="tab-btn w-full text-center py-2 px-3 font-medium rounded-xl">Schedule</button>
  <button onclick="showTab('devices')" class="tab-btn w-full text-center py-2 px-3 font-medium rounded-xl">Devices</button>
  <button onclick="showTab('settings')" class="tab-btn w-full text-center py-2 px-3 font-medium rounded-xl">Settings</button>
  <button onclick="showTab('tips')" class="tab-btn w-full text-center py-2 px-3 font-medium rounded-xl">Tips</button>
</nav>

<!-- Tabs Content -->
<section id="schedule" class="tab-content">
  <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-soft mb-4">
    <label for="postcode" class="block font-semibold mb-2">Enter your postcode</label>
    <input id="postcodeInput" type="text" class="w-full px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600" placeholder="e.g. M1 1AA" />
    <button onclick="fetchSchedule()" class="w-full mt-3 bg-primary text-white py-2 rounded-xl font-semibold">Get Schedule</button>
  </div>
  <div id="scheduleOutput" class="space-y-3"></div>
</section>

<section id="devices" class="tab-content hidden">
  <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-soft">
    <p class="font-semibold mb-2">Connected Devices</p>
    <div id="connectedDevices">None</div>
    <button onclick="scanBluetoothDevices()" class="mt-4 bg-primary text-white py-2 px-4 rounded-xl font-semibold">Scan via Bluetooth</button>
  </div>
</section>

<section id="settings" class="tab-content hidden">
  <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-soft space-y-3">
    <div class="flex justify-between items-center">
      <label class="font-medium">Push Notifications</label>
      <input id="pushToggle" type="checkbox" checked class="toggle-input" />
    </div>
    <div class="flex justify-between items-center">
      <label class="font-medium">Auto Brightness</label>
      <input type="checkbox" class="toggle-input" />
    </div>
    <div>
      <label class="block font-medium mb-1">Light Duration</label>
      <select class="w-full px-3 py-2 rounded-xl bg-white dark:bg-gray-700">
        <option>Until collection</option>
        <option>24 hours</option>
        <option>12 hours</option>
        <option>6 hours</option>
      </select>
    </div>
  </div>
</section>

<section id="tips" class="tab-content hidden">
  <div class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-soft">
    <h2 class="font-bold text-lg mb-3">Recycling Tips & News</h2>
    <div id="rssFeed" class="space-y-2 text-sm"></div>
  </div>
</section>

  </div>  <script>
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
      document.getElementById(tabId).classList.remove('hidden');
      if (tabId === 'tips') loadRSSFeed();
    }

    async function fetchSchedule() {
      const output = document.getElementById('scheduleOutput');
      output.innerHTML = '<p>Loading...</p>';
      const postcode = document.getElementById('postcodeInput').value;
      try {
        const res = await fetch(`/api/bindata?postcode=${encodeURIComponent(postcode)}`);
        const data = await res.json();
        if (!data.bins) throw new Error('No data');
        output.innerHTML = data.bins.map(bin => `<div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-xl shadow-soft">
          <p class="font-semibold">${bin.type}</p>
          <p class="text-xs">${new Date(bin.collectionDate).toLocaleDateString()}</p>
        </div>`).join('');
      } catch (err) {
        output.innerHTML = '<p class="text-red-500">Failed to load schedule.</p>';
      }
    }

    async function loadRSSFeed() {
      const container = document.getElementById('rssFeed');
      container.innerHTML = '<p>Loading...</p>';
      try {
        const res = await fetch('/api/rss');
        const { items } = await res.json();
        container.innerHTML = items.map(item => `<div class="bg-gray-100 dark:bg-gray-700 p-3 rounded-xl shadow-soft">
          <a href="${item.link}" target="_blank" class="font-semibold text-blue-600 dark:text-blue-400">${item.title}</a>
          <p class="text-xs text-gray-500">${new Date(item.pubDate).toLocaleDateString()}</p>
        </div>`).join('');
      } catch {
        container.innerHTML = '<p class="text-red-500">RSS feed unavailable.</p>';
      }
    }

    function scanBluetoothDevices() {
      alert("Bluetooth scanning feature not implemented yet.");
    }
  </script>  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js').then(() => {
          console.log('Service Worker registered');
        });
      });
    }
  </script></body>
</html>